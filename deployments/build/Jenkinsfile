pipeline {
  agent any
  stages {
    stage('build image') {
        steps {
            dir("deployments/build") {
          
                withAWS(credentials: 'epuerta-challenge', region: 'us-east-2'){
                    
                    latestTag = sh(returnStdout:  true, script: "git tag --sort=-creatordate | head -n 1").trim()
                    env.BUILD_VERSION = latestTag
                    sh './build_web.sh $GIT_BRANCH ${env.BUILD_VERSION}'
                   

                }
            }
        }
    }
  }
}
